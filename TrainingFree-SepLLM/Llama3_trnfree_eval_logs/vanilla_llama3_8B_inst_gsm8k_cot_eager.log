2025-06-19:16:55:31,754 INFO     [__main__.py:279] Verbosity set to INFO
2025-06-19:16:55:31,803 INFO     [__init__.py:491] `group` and `group_alias` keys in TaskConfigs are deprecated and will be removed in v0.4.5 of lm_eval. The new `tag` field will be used to allow for a shortcut to a group of tasks one does not wish to aggregate metrics across. `group`s which aggregate across subtasks must be only defined in a separate group config file, which will be the official way to create groups that support cross-task aggregation as in `mmlu`. Please see the v0.4.4 patch notes and our documentation: https://github.com/EleutherAI/lm-evaluation-harness/blob/main/docs/new_task_guide.md#advanced-group-configs for more information.
2025-06-19:16:55:38,616 INFO     [__main__.py:376] Selected Tasks: ['gsm8k_cot']
2025-06-19:16:55:38,620 INFO     [evaluator.py:161] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2025-06-19:16:55:38,620 INFO     [evaluator.py:198] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'attn_implementation': 'eager', 'sepllm_config': './Llama3_trnfree_sepllm_configs/llama3_original_vanilla.yml'}
2025-06-19:16:55:39,574 INFO     [huggingface.py:130] Using device 'cuda:0'
/home/txiao/miniconda3/envs/py39_cu121_torch251_new2/lib/python3.10/site-packages/huggingface_hub/file_download.py:797: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2025-06-19:16:55:40,146 INFO     [huggingface.py:366] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
Warnings:>>> `self.Layer_num: int` (32), i.e., the number of layers of the current LM, must be correctly set!
############################################ Basic Args for SepAttention ############################################
self.prefill_local_window_size: 8192
self.generate_local_window_size: 8192
self.PADDING_ID: 128009 --- Must be correctly set.
self.Layer_num: 32 --- Must be correctly set.
self.init_tok_max_idx: 2
self.USE_ORIGINAL_FULL_ATTEN:  True
self.streamingLLM:  False
self.BATCH_ADAPTIVE_INIT_POS:  True
>>> For `BATCH_ADAPTIVE_INIT_POS`: Typically True when the input_ids of the model use 'left padding', False for 'right padding'.
self.PRINT_KV_RATIO:  True
self.print_ratio_intervals:  10
>>>Note: Please be careful of the `separator_token_ids`, and make sure they are correct for the current LLM
self.separator_token_ids: [-1]
self.USE_BiPE: False
self.EXCLUDE_DIAGONAL:  True
>>>>>>>>---------##########################################################-----------<<<<<<<<
>>>>>>>>---------               USE_ORIGINAL_FULL_ATTEN                    -----------<<<<<<<<
>>>>>>>>--------- Running the original full attention LLM (no changing).--------------<<<<<<<<
>>>>>>>>--------- All SepLLM-related settings will NOT take any effect     -----------<<<<<<<<
>>>>>>>>---------##########################################################-----------<<<<<<<<
################>>>>>>>>>>> Current `config._attn_implementation`: eager <<<<<<<<<###################
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.64s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.36s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.22s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.19it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.03s/it]
2025-06-19:16:55:49,203 INFO     [evaluator.py:279] Setting fewshot random generator seed to 1234
2025-06-19:16:55:49,203 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-06-19:16:55:49,204 INFO     [task.py:423] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/1319 [00:00<?, ?it/s]  1%|          | 13/1319 [00:00<00:10, 126.60it/s]  2%|▏         | 27/1319 [00:00<00:10, 128.93it/s]  3%|▎         | 40/1319 [00:00<00:09, 128.99it/s]  4%|▍         | 53/1319 [00:00<00:09, 129.32it/s]  5%|▌         | 66/1319 [00:00<00:09, 129.46it/s]  6%|▌         | 79/1319 [00:00<00:09, 129.13it/s]  7%|▋         | 92/1319 [00:00<00:09, 129.40it/s]  8%|▊         | 105/1319 [00:00<00:09, 129.13it/s]  9%|▉         | 118/1319 [00:00<00:09, 129.12it/s] 10%|█         | 132/1319 [00:01<00:09, 129.79it/s] 11%|█         | 146/1319 [00:01<00:08, 130.36it/s] 12%|█▏        | 160/1319 [00:01<00:08, 130.61it/s] 13%|█▎        | 174/1319 [00:01<00:08, 130.68it/s] 14%|█▍        | 188/1319 [00:01<00:08, 130.77it/s] 15%|█▌        | 202/1319 [00:01<00:08, 130.43it/s] 16%|█▋        | 216/1319 [00:01<00:08, 130.82it/s] 17%|█▋        | 230/1319 [00:01<00:08, 131.22it/s] 18%|█▊        | 244/1319 [00:01<00:08, 131.69it/s] 20%|█▉        | 258/1319 [00:01<00:08, 132.18it/s] 21%|██        | 272/1319 [00:02<00:07, 132.36it/s] 22%|██▏       | 286/1319 [00:02<00:07, 132.47it/s] 23%|██▎       | 300/1319 [00:02<00:07, 132.48it/s] 24%|██▍       | 314/1319 [00:02<00:07, 132.86it/s] 25%|██▍       | 328/1319 [00:02<00:07, 132.42it/s] 26%|██▌       | 342/1319 [00:02<00:07, 132.35it/s] 27%|██▋       | 356/1319 [00:02<00:07, 132.36it/s] 28%|██▊       | 370/1319 [00:02<00:07, 131.90it/s] 29%|██▉       | 384/1319 [00:02<00:07, 131.65it/s] 30%|███       | 398/1319 [00:03<00:06, 131.89it/s] 31%|███       | 412/1319 [00:03<00:06, 132.35it/s] 32%|███▏      | 426/1319 [00:03<00:06, 132.07it/s] 33%|███▎      | 440/1319 [00:03<00:06, 131.87it/s] 34%|███▍      | 454/1319 [00:03<00:06, 132.21it/s] 35%|███▌      | 468/1319 [00:03<00:06, 128.52it/s] 36%|███▋      | 481/1319 [00:03<00:06, 125.91it/s] 37%|███▋      | 494/1319 [00:03<00:06, 125.79it/s] 38%|███▊      | 507/1319 [00:03<00:06, 125.31it/s] 39%|███▉      | 520/1319 [00:03<00:06, 125.73it/s] 40%|████      | 534/1319 [00:04<00:06, 127.68it/s] 42%|████▏     | 548/1319 [00:04<00:05, 129.38it/s] 43%|████▎     | 561/1319 [00:04<00:05, 128.88it/s] 44%|████▎     | 574/1319 [00:04<00:05, 129.13it/s] 45%|████▍     | 587/1319 [00:04<00:05, 129.06it/s] 45%|████▌     | 600/1319 [00:04<00:05, 127.85it/s] 47%|████▋     | 614/1319 [00:04<00:05, 129.24it/s] 48%|████▊     | 627/1319 [00:04<00:05, 128.63it/s] 49%|████▊     | 640/1319 [00:04<00:05, 128.61it/s] 50%|████▉     | 654/1319 [00:05<00:05, 129.40it/s] 51%|█████     | 667/1319 [00:05<00:05, 128.98it/s] 52%|█████▏    | 681/1319 [00:05<00:04, 129.59it/s] 53%|█████▎    | 694/1319 [00:05<00:04, 129.71it/s] 54%|█████▎    | 708/1319 [00:05<00:04, 130.78it/s] 55%|█████▍    | 722/1319 [00:05<00:04, 131.95it/s] 56%|█████▌    | 736/1319 [00:05<00:04, 131.85it/s] 57%|█████▋    | 750/1319 [00:05<00:04, 131.34it/s] 58%|█████▊    | 764/1319 [00:05<00:04, 131.96it/s] 59%|█████▉    | 778/1319 [00:05<00:04, 131.45it/s] 60%|██████    | 792/1319 [00:06<00:04, 131.39it/s] 61%|██████    | 806/1319 [00:06<00:03, 130.85it/s] 62%|██████▏   | 820/1319 [00:06<00:03, 131.33it/s] 63%|██████▎   | 834/1319 [00:06<00:03, 131.45it/s] 64%|██████▍   | 848/1319 [00:06<00:03, 131.22it/s] 65%|██████▌   | 862/1319 [00:06<00:03, 132.05it/s] 66%|██████▋   | 876/1319 [00:06<00:03, 132.47it/s] 67%|██████▋   | 890/1319 [00:06<00:03, 132.78it/s] 69%|██████▊   | 904/1319 [00:06<00:03, 133.15it/s] 70%|██████▉   | 918/1319 [00:07<00:03, 133.43it/s] 71%|███████   | 932/1319 [00:07<00:02, 133.94it/s] 72%|███████▏  | 946/1319 [00:07<00:02, 134.19it/s] 73%|███████▎  | 960/1319 [00:07<00:02, 134.28it/s] 74%|███████▍  | 974/1319 [00:07<00:02, 134.32it/s] 75%|███████▍  | 988/1319 [00:07<00:02, 134.30it/s] 76%|███████▌  | 1002/1319 [00:07<00:02, 134.31it/s] 77%|███████▋  | 1016/1319 [00:07<00:02, 134.09it/s] 78%|███████▊  | 1030/1319 [00:07<00:02, 133.70it/s] 79%|███████▉  | 1044/1319 [00:07<00:02, 133.74it/s] 80%|████████  | 1058/1319 [00:08<00:01, 132.35it/s] 81%|████████▏ | 1072/1319 [00:08<00:01, 130.59it/s] 82%|████████▏ | 1086/1319 [00:08<00:01, 130.45it/s] 83%|████████▎ | 1100/1319 [00:08<00:01, 131.13it/s] 84%|████████▍ | 1114/1319 [00:08<00:01, 130.93it/s] 86%|████████▌ | 1128/1319 [00:08<00:01, 131.62it/s] 87%|████████▋ | 1142/1319 [00:08<00:01, 132.10it/s] 88%|████████▊ | 1156/1319 [00:08<00:01, 132.28it/s] 89%|████████▊ | 1170/1319 [00:08<00:01, 131.72it/s] 90%|████████▉ | 1184/1319 [00:09<00:01, 131.54it/s] 91%|█████████ | 1198/1319 [00:09<00:00, 130.90it/s] 92%|█████████▏| 1212/1319 [00:09<00:00, 130.75it/s] 93%|█████████▎| 1226/1319 [00:09<00:00, 131.31it/s] 94%|█████████▍| 1240/1319 [00:09<00:00, 130.36it/s] 95%|█████████▌| 1254/1319 [00:09<00:00, 130.23it/s] 96%|█████████▌| 1268/1319 [00:09<00:00, 129.85it/s] 97%|█████████▋| 1281/1319 [00:09<00:00, 129.65it/s] 98%|█████████▊| 1294/1319 [00:09<00:00, 129.49it/s] 99%|█████████▉| 1307/1319 [00:09<00:00, 129.17it/s]100%|██████████| 1319/1319 [00:10<00:00, 130.86it/s]
2025-06-19:16:55:59,301 INFO     [evaluator.py:465] Running generate_until requests
Running generate_until requests:   0%|          | 0/1319 [00:00<?, ?it/s]/home/txiao/miniconda3/envs/py39_cu121_torch251_new2/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/txiao/miniconda3/envs/py39_cu121_torch251_new2/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Running generate_until requests:   0%|          | 1/1319 [00:27<10:11:39, 27.84s/it]Running generate_until requests:   5%|▌         | 71/1319 [00:51<12:46,  1.63it/s]  Running generate_until requests:  11%|█         | 141/1319 [01:15<08:51,  2.22it/s]Running generate_until requests:  16%|█▌        | 211/1319 [01:32<06:38,  2.78it/s]Running generate_until requests:  21%|██▏       | 281/1319 [01:50<05:31,  3.14it/s]Running generate_until requests:  27%|██▋       | 351/1319 [02:06<04:38,  3.48it/s]Running generate_until requests:  32%|███▏      | 421/1319 [02:30<04:31,  3.31it/s]Running generate_until requests:  37%|███▋      | 491/1319 [02:44<03:43,  3.70it/s]Running generate_until requests:  43%|████▎     | 561/1319 [02:57<03:03,  4.12it/s]Running generate_until requests:  48%|████▊     | 631/1319 [03:15<02:49,  4.06it/s]Running generate_until requests:  53%|█████▎    | 701/1319 [03:34<02:38,  3.90it/s]Running generate_until requests:  58%|█████▊    | 771/1319 [03:46<02:06,  4.33it/s]Running generate_until requests:  64%|██████▍   | 841/1319 [03:59<01:43,  4.60it/s]Running generate_until requests:  69%|██████▉   | 911/1319 [04:16<01:31,  4.44it/s]Running generate_until requests:  74%|███████▍  | 981/1319 [04:29<01:12,  4.68it/s]Running generate_until requests:  80%|███████▉  | 1051/1319 [04:44<00:56,  4.72it/s]Running generate_until requests:  85%|████████▍ | 1121/1319 [05:03<00:45,  4.37it/s]Running generate_until requests:  90%|█████████ | 1191/1319 [05:14<00:26,  4.78it/s]Running generate_until requests:  96%|█████████▌| 1261/1319 [05:26<00:11,  5.06it/s]Running generate_until requests: 100%|██████████| 1319/1319 [05:26<00:00,  4.04it/s]
fatal: not a git repository (or any parent up to mount point /lustre)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-06-19:17:01:32,221 INFO     [evaluation_tracker.py:269] Output path not provided, skipping saving results aggregated
hf (pretrained=meta-llama/Meta-Llama-3-8B-Instruct,attn_implementation=eager,sepllm_config=./Llama3_trnfree_sepllm_configs/llama3_original_vanilla.yml), gen_kwargs: (None), limit: None, num_fewshot: None, batch_size: 70
|  Tasks  |Version|     Filter     |n-shot|  Metric   |   |Value |   |Stderr|
|---------|------:|----------------|-----:|-----------|---|-----:|---|-----:|
|gsm8k_cot|      3|flexible-extract|     8|exact_match|↑  |0.7756|±  |0.0115|
|         |       |strict-match    |     8|exact_match|↑  |0.7703|±  |0.0116|

