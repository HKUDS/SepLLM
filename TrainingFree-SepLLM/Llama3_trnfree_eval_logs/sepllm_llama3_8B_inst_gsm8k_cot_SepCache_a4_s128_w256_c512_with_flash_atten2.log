2025-06-24:08:40:10,757 INFO     [__main__.py:279] Verbosity set to INFO
2025-06-24:08:40:10,827 INFO     [__init__.py:491] `group` and `group_alias` keys in TaskConfigs are deprecated and will be removed in v0.4.5 of lm_eval. The new `tag` field will be used to allow for a shortcut to a group of tasks one does not wish to aggregate metrics across. `group`s which aggregate across subtasks must be only defined in a separate group config file, which will be the official way to create groups that support cross-task aggregation as in `mmlu`. Please see the v0.4.4 patch notes and our documentation: https://github.com/EleutherAI/lm-evaluation-harness/blob/main/docs/new_task_guide.md#advanced-group-configs for more information.
2025-06-24:08:40:18,631 INFO     [__main__.py:376] Selected Tasks: ['gsm8k_cot']
2025-06-24:08:40:18,637 INFO     [evaluator.py:161] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2025-06-24:08:40:18,637 INFO     [evaluator.py:198] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'attn_implementation': 'flash_attention_2'}
2025-06-24:08:40:20,562 INFO     [huggingface.py:130] Using device 'cuda:0'
/home/txiao/miniconda3/envs/py39_cu121_torch251_new2/lib/python3.10/site-packages/huggingface_hub/file_download.py:797: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2025-06-24:08:40:21,091 INFO     [huggingface.py:366] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda:0'}
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards:  25%|██▌       | 1/4 [01:42<05:07, 102.55s/it]Downloading shards:  50%|█████     | 2/4 [03:48<03:52, 116.12s/it]Downloading shards:  75%|███████▌  | 3/4 [05:52<01:59, 119.89s/it]Downloading shards: 100%|██████████| 4/4 [06:32<00:00, 88.31s/it] Downloading shards: 100%|██████████| 4/4 [06:32<00:00, 98.11s/it]
################>>>>>>>>>>> Current `config._attn_implementation`: flash_attention_2 <<<<<<<<<###################
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:12<00:37, 12.49s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:24<00:24, 12.35s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:37<00:12, 12.36s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:40<00:00,  8.67s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:40<00:00, 10.03s/it]
2025-06-24:08:47:38,645 INFO     [evaluator.py:279] Setting fewshot random generator seed to 1234
2025-06-24:08:47:38,646 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-06-24:08:47:38,647 INFO     [task.py:423] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/1319 [00:00<?, ?it/s]  1%|          | 14/1319 [00:00<00:09, 134.49it/s]  2%|▏         | 28/1319 [00:00<00:09, 135.57it/s]  3%|▎         | 42/1319 [00:00<00:09, 135.93it/s]  4%|▍         | 56/1319 [00:00<00:09, 136.43it/s]  5%|▌         | 70/1319 [00:00<00:09, 136.88it/s]  6%|▋         | 84/1319 [00:00<00:08, 137.31it/s]  7%|▋         | 98/1319 [00:00<00:08, 137.56it/s]  8%|▊         | 112/1319 [00:00<00:08, 137.88it/s] 10%|▉         | 126/1319 [00:00<00:08, 137.91it/s] 11%|█         | 140/1319 [00:01<00:08, 138.03it/s] 12%|█▏        | 154/1319 [00:01<00:08, 138.03it/s] 13%|█▎        | 168/1319 [00:01<00:08, 138.13it/s] 14%|█▍        | 182/1319 [00:01<00:08, 138.31it/s] 15%|█▍        | 196/1319 [00:01<00:08, 138.40it/s] 16%|█▌        | 210/1319 [00:01<00:08, 138.50it/s] 17%|█▋        | 224/1319 [00:01<00:07, 138.03it/s] 18%|█▊        | 238/1319 [00:01<00:07, 138.38it/s] 19%|█▉        | 252/1319 [00:01<00:07, 138.56it/s] 20%|██        | 266/1319 [00:01<00:07, 138.68it/s] 21%|██        | 280/1319 [00:02<00:07, 138.78it/s] 22%|██▏       | 294/1319 [00:02<00:07, 138.76it/s] 23%|██▎       | 308/1319 [00:02<00:07, 138.83it/s] 24%|██▍       | 322/1319 [00:02<00:07, 138.86it/s] 25%|██▌       | 336/1319 [00:02<00:07, 138.92it/s] 27%|██▋       | 350/1319 [00:02<00:06, 139.01it/s] 28%|██▊       | 364/1319 [00:02<00:06, 139.01it/s] 29%|██▊       | 378/1319 [00:02<00:06, 139.02it/s] 30%|██▉       | 392/1319 [00:02<00:06, 138.86it/s] 31%|███       | 406/1319 [00:02<00:06, 138.85it/s] 32%|███▏      | 420/1319 [00:03<00:06, 138.70it/s] 33%|███▎      | 434/1319 [00:03<00:06, 138.66it/s] 34%|███▍      | 448/1319 [00:03<00:06, 138.52it/s] 35%|███▌      | 462/1319 [00:03<00:06, 138.60it/s] 36%|███▌      | 476/1319 [00:03<00:06, 138.40it/s] 37%|███▋      | 490/1319 [00:03<00:05, 138.54it/s] 38%|███▊      | 504/1319 [00:03<00:05, 138.56it/s] 39%|███▉      | 518/1319 [00:03<00:05, 138.44it/s] 40%|████      | 532/1319 [00:03<00:05, 138.54it/s] 41%|████▏     | 546/1319 [00:03<00:05, 138.48it/s] 42%|████▏     | 560/1319 [00:04<00:05, 138.45it/s] 44%|████▎     | 574/1319 [00:04<00:05, 138.34it/s] 45%|████▍     | 588/1319 [00:04<00:05, 138.38it/s] 46%|████▌     | 602/1319 [00:04<00:05, 138.43it/s] 47%|████▋     | 616/1319 [00:04<00:05, 138.31it/s] 48%|████▊     | 630/1319 [00:04<00:04, 138.34it/s] 49%|████▉     | 644/1319 [00:04<00:04, 138.35it/s] 50%|████▉     | 658/1319 [00:04<00:04, 138.32it/s] 51%|█████     | 672/1319 [00:04<00:04, 138.24it/s] 52%|█████▏    | 686/1319 [00:04<00:04, 138.23it/s] 53%|█████▎    | 700/1319 [00:05<00:04, 138.22it/s] 54%|█████▍    | 714/1319 [00:05<00:04, 138.22it/s] 55%|█████▌    | 728/1319 [00:05<00:04, 138.28it/s] 56%|█████▋    | 742/1319 [00:05<00:04, 136.87it/s] 57%|█████▋    | 756/1319 [00:05<00:04, 137.26it/s] 58%|█████▊    | 770/1319 [00:05<00:03, 137.76it/s] 59%|█████▉    | 784/1319 [00:05<00:03, 138.08it/s] 61%|██████    | 798/1319 [00:05<00:03, 138.14it/s] 62%|██████▏   | 812/1319 [00:05<00:03, 138.19it/s] 63%|██████▎   | 826/1319 [00:05<00:03, 138.25it/s] 64%|██████▎   | 840/1319 [00:06<00:03, 138.30it/s] 65%|██████▍   | 854/1319 [00:06<00:03, 138.33it/s] 66%|██████▌   | 868/1319 [00:06<00:03, 138.42it/s] 67%|██████▋   | 882/1319 [00:06<00:03, 138.41it/s] 68%|██████▊   | 896/1319 [00:06<00:03, 138.36it/s] 69%|██████▉   | 910/1319 [00:06<00:02, 138.20it/s] 70%|███████   | 924/1319 [00:06<00:02, 138.19it/s] 71%|███████   | 938/1319 [00:06<00:02, 138.22it/s] 72%|███████▏  | 952/1319 [00:06<00:02, 138.18it/s] 73%|███████▎  | 966/1319 [00:06<00:02, 138.29it/s] 74%|███████▍  | 980/1319 [00:07<00:02, 138.30it/s] 75%|███████▌  | 994/1319 [00:07<00:02, 138.27it/s] 76%|███████▋  | 1008/1319 [00:07<00:02, 138.25it/s] 77%|███████▋  | 1022/1319 [00:07<00:02, 138.11it/s] 79%|███████▊  | 1036/1319 [00:07<00:02, 138.33it/s] 80%|███████▉  | 1050/1319 [00:07<00:01, 138.59it/s] 81%|████████  | 1064/1319 [00:07<00:01, 138.73it/s] 82%|████████▏ | 1078/1319 [00:07<00:01, 138.77it/s] 83%|████████▎ | 1092/1319 [00:07<00:01, 138.73it/s] 84%|████████▍ | 1106/1319 [00:07<00:01, 138.64it/s] 85%|████████▍ | 1120/1319 [00:08<00:01, 138.58it/s] 86%|████████▌ | 1134/1319 [00:08<00:01, 138.56it/s] 87%|████████▋ | 1148/1319 [00:08<00:01, 138.58it/s] 88%|████████▊ | 1162/1319 [00:08<00:01, 138.42it/s] 89%|████████▉ | 1176/1319 [00:08<00:01, 138.26it/s] 90%|█████████ | 1190/1319 [00:08<00:00, 138.07it/s] 91%|█████████▏| 1204/1319 [00:08<00:00, 137.75it/s] 92%|█████████▏| 1218/1319 [00:08<00:00, 137.71it/s] 93%|█████████▎| 1232/1319 [00:08<00:00, 137.58it/s] 94%|█████████▍| 1246/1319 [00:09<00:00, 137.39it/s] 96%|█████████▌| 1260/1319 [00:09<00:00, 137.29it/s] 97%|█████████▋| 1274/1319 [00:09<00:00, 137.24it/s] 98%|█████████▊| 1288/1319 [00:09<00:00, 137.25it/s] 99%|█████████▊| 1302/1319 [00:09<00:00, 137.21it/s]100%|█████████▉| 1316/1319 [00:09<00:00, 137.14it/s]100%|██████████| 1319/1319 [00:09<00:00, 138.16it/s]
2025-06-24:08:47:48,211 INFO     [evaluator.py:465] Running generate_until requests
Running generate_until requests:   0%|          | 0/1319 [00:00<?, ?it/s]/home/txiao/miniconda3/envs/py39_cu121_torch251_new2/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/txiao/miniconda3/envs/py39_cu121_torch251_new2/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Running generate_until requests:   0%|          | 1/1319 [00:20<7:31:20, 20.55s/it]Running generate_until requests:   6%|▌         | 81/1319 [00:36<07:44,  2.66it/s] Running generate_until requests:  12%|█▏        | 161/1319 [00:51<05:11,  3.72it/s]Running generate_until requests:  18%|█▊        | 241/1319 [01:07<04:12,  4.27it/s]Running generate_until requests:  24%|██▍       | 321/1319 [01:22<03:37,  4.59it/s]Running generate_until requests:  30%|███       | 401/1319 [01:38<03:11,  4.79it/s]Running generate_until requests:  36%|███▋      | 481/1319 [01:53<02:50,  4.93it/s]Running generate_until requests:  43%|████▎     | 561/1319 [02:08<02:31,  5.02it/s]Running generate_until requests:  49%|████▊     | 641/1319 [02:24<02:13,  5.08it/s]Running generate_until requests:  55%|█████▍    | 721/1319 [02:37<01:51,  5.35it/s]Running generate_until requests:  61%|██████    | 801/1319 [02:52<01:37,  5.31it/s]Running generate_until requests:  67%|██████▋   | 881/1319 [03:03<01:15,  5.78it/s]Running generate_until requests:  73%|███████▎  | 961/1319 [03:19<01:03,  5.60it/s]Running generate_until requests:  79%|███████▉  | 1041/1319 [03:30<00:46,  5.94it/s]Running generate_until requests:  85%|████████▍ | 1121/1319 [03:45<00:34,  5.71it/s]Running generate_until requests:  91%|█████████ | 1201/1319 [04:01<00:21,  5.57it/s]Running generate_until requests:  97%|█████████▋| 1281/1319 [04:12<00:06,  5.92it/s]Running generate_until requests: 100%|██████████| 1319/1319 [04:12<00:00,  5.22it/s]
fatal: not a git repository (or any parent up to mount point /lustre)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-06-24:08:52:08,122 INFO     [evaluation_tracker.py:269] Output path not provided, skipping saving results aggregated
######################## The KVs for ALL layers: (KV number kept for predicting current token)/(Total seen KV number) ########################
########################>>>>>>>>>>> [Kept Tokens, Seen Tokens] : (1825377280, 3454499520), Ratio: 0.5284 <<<<<<<<<<<<##########################
######################## -------------------------------------------------------------------------------------------- ########################
######################## The KVs for ALL layers: (KV number kept for predicting current token)/(Total seen KV number) ########################
########################>>>>>>>>>>> [Kept Tokens, Seen Tokens] : (3573442016, 6733915360), Ratio: 0.5307 <<<<<<<<<<<<##########################
######################## -------------------------------------------------------------------------------------------- ########################
######################## The KVs for ALL layers: (KV number kept for predicting current token)/(Total seen KV number) ########################
########################>>>>>>>>>>> [Kept Tokens, Seen Tokens] : (5144431328, 9652977248), Ratio: 0.5329 <<<<<<<<<<<<##########################
######################## -------------------------------------------------------------------------------------------- ########################
######################## The KVs for ALL layers: (KV number kept for predicting current token)/(Total seen KV number) ########################
########################>>>>>>>>>>> [Kept Tokens, Seen Tokens] : (6774214816, 12641034944), Ratio: 0.5359 <<<<<<<<<<<<##########################
######################## -------------------------------------------------------------------------------------------- ########################
hf (pretrained=meta-llama/Meta-Llama-3-8B-Instruct,attn_implementation=flash_attention_2), gen_kwargs: (None), limit: None, num_fewshot: None, batch_size: 80
|  Tasks  |Version|     Filter     |n-shot|  Metric   |   |Value |   |Stderr|
|---------|------:|----------------|-----:|-----------|---|-----:|---|-----:|
|gsm8k_cot|      3|flexible-extract|     8|exact_match|↑  |0.7672|±  |0.0116|
|         |       |strict-match    |     8|exact_match|↑  |0.7703|±  |0.0116|

